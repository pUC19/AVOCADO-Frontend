<html lang="de" data-bs-theme="light">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}AVOCADO{% endblock %}</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="icon" href="{{ url_for('static', filename='favicon.png') }}">
  <style>
    :root{
      --radius: 16px;
      --shadow: 0 10px 30px rgba(0,0,0,.06), 0 2px 6px rgba(0,0,0,.05);
      --card-bg: color-mix(in oklab, var(--bs-body-bg), transparent 10%);
    }
    /* Navbar-Variablen f√ºr LIGHT */
    .navbar-blur{
      --bs-navbar-color: rgba(33,37,41,.85);
      --bs-navbar-hover-color: rgba(33,37,41,1);
      --bs-navbar-brand-color: rgba(33,37,41,1);
      --bs-navbar-brand-hover-color: rgba(33,37,41,.85);
      --bs-navbar-toggler-border-color: rgba(33,37,41,.25);
      --bs-navbar-toggler-icon-bg: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3E%3Cpath stroke='rgba(0,0,0,0.75)' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3E%3C/svg%3E");
    }
    /* Navbar-Variablen f√ºr DARK */
    [data-bs-theme="dark"] .navbar-blur{
      --bs-navbar-color: rgba(255,255,255,.75);
      --bs-navbar-hover-color: #fff;
      --bs-navbar-brand-color: #fff;
      --bs-navbar-brand-hover-color: #f8f9fa;
      --bs-navbar-toggler-border-color: rgba(255,255,255,.25);
      --bs-navbar-toggler-icon-bg: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3E%3Cpath stroke='rgba(255,255,255,0.85)' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3E%3C/svg%3E");
    }

    [data-bs-theme="dark"]{
      --shadow: 0 10px 30px rgba(0,0,0,.35), 0 2px 6px rgba(0,0,0,.25);
      --card-bg: color-mix(in oklab, var(--bs-body-bg), white 4%);
    }
    html,body{ height:100%; }
    body{
      background:
        radial-gradient(1000px 600px at 10% -10%, rgba(99,102,241,.18), transparent 40%),
        radial-gradient(800px 500px at 90% 10%, rgba(14,165,233,.18), transparent 40%),
        linear-gradient(to bottom, var(--bs-body-bg), var(--bs-body-bg));
      background-attachment: fixed;
    }
    .navbar-blur{
      backdrop-filter: saturate(140%) blur(10px);
      background: color-mix(in oklab, var(--bs-body-bg), transparent 20%) !important;
      border-bottom: 1px solid color-mix(in oklab, var(--bs-body-color), transparent 90%);
    }
    .card-glass{
      background: var(--card-bg);
      border: 1px solid color-mix(in oklab, var(--bs-body-color), transparent 90%);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }
    .mono{ font-family: ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono",monospace; }
    .logbox{ height: 300px; overflow:auto; border-radius: 12px; background: #0b1020; color:#a7f3d0; padding:.75rem; }
    .chip{
      display:inline-flex; align-items:center; gap:.5rem;
      padding:.35rem .6rem; border-radius:999px;
      border:1px solid color-mix(in oklab, var(--bs-body-color), transparent 85%);
      background: color-mix(in oklab, var(--bs-body-bg), transparent 10%);
      font-size:.875rem;
    }
    .truncate{ max-width: 100%; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
    .plot-wrap{ height: clamp(360px, 60vh, 680px); }
    .sticky-actions{
      position: sticky; bottom: 0; z-index: 5;
      background: color-mix(in oklab, var(--bs-body-bg), transparent 5%);
      backdrop-filter: blur(6px);
      border-top: 1px solid color-mix(in oklab, var(--bs-body-color), transparent 90%);
      padding: .75rem;
      border-bottom-left-radius: var(--radius);
      border-bottom-right-radius: var(--radius);
    }
    .btn-soft{
      border:1px solid color-mix(in oklab, var(--bs-body-color), transparent 85%);
      background: color-mix(in oklab, var(--bs-body-bg), transparent 6%);
    }
    .btn-soft:hover{ background: color-mix(in oklab, var(--bs-body-bg), transparent 0%); }
    .section-title{ letter-spacing:.3px }
    .toast-container { z-index: 2000; }
  </style>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-blur sticky-top">
  <div class="container-xl">
    <a class="navbar-brand fw-semibold d-flex align-items-center" href="{{ url_for('start') }}">
      <img src="{{ url_for('static', filename='favicon.png') }}" alt="AVOCADO" width="24" height="24" class="me-2">
      <span>AVOCADO</span>
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#nav" aria-label="Navigation umschalten"></button>
    <div id="nav" class="collapse navbar-collapse">
      <ul class="navbar-nav me-auto">
        <li class="nav-item"><a class="nav-link" href="{{ url_for('start') }}">Start</a></li>
        <li class="nav-item"><a class="nav-link" href="{{ url_for('avocado') }}">Avocado</a></li>
        <li class="nav-item"><a class="nav-link" href="{{ url_for('tomato_page') }}">TOMATO</a></li>
        <li class="nav-item"><a class="nav-link" href="{{ url_for('ot_page') }}">OT-Auswertung</a></li>
      </ul>
      <div class="d-flex align-items-center gap-2">
        <button id="themeToggle" class="btn btn-outline-light btn-sm" title="Theme umschalten">üåì</button>
      </div>
    </div>
  </div>
</nav>

<main class="container-xl my-4">
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class="toast-container position-fixed top-0 end-0 p-3">
        {% for category, msg in messages %}
          <div class="toast align-items-center text-bg-{% if category=='warning' %}warning{% else %}info{% endif %} border-0 show" role="alert">
            <div class="d-flex">
              <div class="toast-body">{{ msg }}</div>
              <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
            </div>
          </div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}
  {% block content %}{% endblock %}
</main>

<footer class="border-top py-4">
  <div class="container-xl small text-muted d-flex flex-wrap gap-2 justify-content-between">
    <span>AVOCADO ¬∑ Flask Frontend</span>
    <span>¬© {{ 2025 }} ‚Äì Made with ‚ù§Ô∏è & Plotly/Bootstrap</span>
  </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
{% block scripts %}{% endblock %}
<script>
  // Theme: follow system + remember choice
  (function(){
    const key = "potato-theme";
    const saved = localStorage.getItem(key);
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const setTheme = t => document.documentElement.setAttribute('data-bs-theme', t);
    setTheme(saved || (prefersDark ? 'dark' : 'light'));
    document.getElementById('themeToggle')?.addEventListener('click', ()=>{
      const cur = document.documentElement.getAttribute('data-bs-theme');
      const next = cur === 'dark' ? 'light' : 'dark';
      setTheme(next); localStorage.setItem(key, next);
    });
  })();
</script>
</body>
</html>